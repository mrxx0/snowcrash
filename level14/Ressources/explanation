This is the final boss of snowcrash, there are no files no executable the home directory is empty.

How to get the flag ? Well we can only run getflag but as user level14 we can't get it.

Let's look at /bin/getflag with gdb as we did earlier for level13

Disassembling the main show us a loooooot of lines even to many to completly understand what we have.
But by looking at it we saw only one call to getuid.

So we tried to set a breakpoint on the line of getuid (444) and do exactly the same thing we did for level13
But we can't access it and the program exit directly.

Indeed there is a test on $eax at line 72 and if we can't pass it, we can't go any further in the execution.
What is the test on eax ?
Let's print it by first setting a breakpoint to line 72.


(gdb) b * main + 72
Breakpoint 1 at 0x804898e

(gdb) b * main + 444
Breakpoint 2 at 0x8048b02
Then we run the program and print the value

(gdb) r
Starting program: /bin/getflag

Breakpoint 1, 0x0804898e in main ()
(gdb) print $eax
$1 = -1

And now we can set it to 1

(gdb) set $eax = 1
(gdb) print $eax
$1 = 1

Let's then go to the other breakpoint after the getuid call and we should be able to go to it.


(gdb) c
Continuing.

Breakpoint 2, 0x08048b02 in main ()

(gdb) print $eax
$3 = 2014

This is the value of getuid from us, level14
We need to change it to the one from flag14

level14@SnowCrash:~$ id flag14
uid=3014(flag14) gid=3014(flag14) groups=3014(flag14),1001(flag)

(gdb) set $eax = 3014
(gdb) c
Continuing.
Check flag.Here is your token : 7QiHafiNa3HVozsaXkawuYrTstxbpABHD8CPnHJ
[Inferior 1 (process 2129) exited normally]
(gdb) quit

