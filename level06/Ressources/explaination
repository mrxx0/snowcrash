On this level we have two files : level06 an executable and level06.php a php file.

When executing the level06 there is an error asking for a file as a parameter.

The level06.php contains 2 functions using a regex.
Learning about it on the internet we found that that one of the regex is vulnerable to code injection.

Indeed the /e placed in the preg_replace executes the command of the second argument.
So we need to understand the meaning of the regex to inject a valid command and then execute the code we want.
As a reminder we need to launch getflag of access to the flag06 user.

As level06 need a valid file as parameter, we need to write in it our little hidden command.

To do that we need to understand the regex.

preg_replace("/(\[x (.*)\])/e", "y(\"\\2\")", $a);

The regex waits for someting starting with an x then anything else. That's that anything else that our /e will execute.

We want to access to the flag06 user so why not ask for a shell access right ?

[x {${system(bash)}}] and boom ! connected as flag06

Then we launch getflag ! We could also directly launch getflag in the file.
